# ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø´Ø§Ù…Ù„ - PostgreSQL Chat API Service

## ğŸ¯ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

**PostgreSQL Chat API** Ù‡ÙŠ Ø®Ø¯Ù…Ø© Ø°ÙƒÙŠØ© Ù…ØªÙƒØ§Ù…Ù„Ø© ØªØªÙŠØ­ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª PostgreSQL Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù„ØºØ© Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ© (Natural Language). Ø§Ù„Ø®Ø¯Ù…Ø© ØªØ³ØªØ®Ø¯Ù… ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ (LLM) Ù„ÙÙ‡Ù… Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØªÙˆÙ„ÙŠØ¯ Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª SQL ÙˆØªÙ‚Ø¯ÙŠÙ… Ø¥Ø¬Ø§Ø¨Ø§Øª Ù…Ù‡Ù†ÙŠØ© Ù…Ø¹ Ø±Ø³ÙˆÙ… Ø¨ÙŠØ§Ù†ÙŠØ© ÙˆØªØ­Ù„ÙŠÙ„Ø§Øª Ø¥Ø­ØµØ§Ø¦ÙŠØ©.

---

## ğŸ“ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ©

### 1. **Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù‡Ø±Ù…ÙŠ**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FastAPI Application                   â”‚
â”‚                      (Port 3300)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚               â”‚               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚   API Layer  â”‚  â”‚ Servicesâ”‚  â”‚    Utils    â”‚
    â”‚   (chat.py)  â”‚  â”‚  Layer  â”‚  â”‚   Layer     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
            â”‚               â”‚               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
    â”‚           Business Logic Layer                â”‚
    â”‚  - Chat Service                               â”‚
    â”‚  - Statistical Analysis                       â”‚
    â”‚  - Visualization Service                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         AI/LLM Layer                          â”‚
    â”‚  - Gemini (Question Refinement)               â”‚
    â”‚  - Gemini (Response Formatting)               â”‚
    â”‚  - LangChain (SQL Generation)                 â”‚
    â”‚  - PandasAI (Chart Generation)                â”‚
    â”‚  - Sensitive Question Detection               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         Data Layer                            â”‚
    â”‚  - PostgreSQL (Main Database)                 â”‚
    â”‚  - MongoDB (Conversations & Sessions)         â”‚
    â”‚  - Query Cache (In-Memory)                    â”‚
    â”‚  - File Storage (Charts & Excel)              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. **Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª**

```
app/
â”œâ”€â”€ main.py                 # Ù†Ù‚Ø·Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
â”œâ”€â”€ config.py               # Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
â”‚
â”œâ”€â”€ api/                    # Ø·Ø¨Ù‚Ø© API
â”‚   â””â”€â”€ chat.py            # Ø¬Ù…ÙŠØ¹ endpoints Ù„Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª
â”‚
â”œâ”€â”€ services/               # Ø·Ø¨Ù‚Ø© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„
â”‚   â”œâ”€â”€ chat_service.py            # Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
â”‚   â”œâ”€â”€ statistical_analysis.py    # Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠ
â”‚   â””â”€â”€ visualization_service.py   # Ø®Ø¯Ù…Ø© Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©
â”‚
â”œâ”€â”€ llm/                    # Ø·Ø¨Ù‚Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
â”‚   â”œâ”€â”€ gemini_client.py           # Ø¹Ù…ÙŠÙ„ Gemini
â”‚   â”œâ”€â”€ question_refiner.py        # ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
â”‚   â”œâ”€â”€ gemini_response_formatter.py  # ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª
â”‚   â”œâ”€â”€ sensitive_question_checker.py # ÙØ­Øµ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø­Ø³Ø§Ø³Ø©
â”‚   â””â”€â”€ prompts.py                 # Prompts Ù…Ø®ØµØµØ©
â”‚
â”œâ”€â”€ db/                     # Ø·Ø¨Ù‚Ø© Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
â”‚   â”œâ”€â”€ mongodb.py                 # MongoDB Manager
â”‚   â””â”€â”€ security.py                # SQL Security
â”‚
â”œâ”€â”€ rag/                    # Retrieval Augmented Generation
â”‚   â””â”€â”€ retriever.py        # Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Schema
â”‚
â”œâ”€â”€ utils/                  # Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
â”‚   â”œâ”€â”€ excel_export.py     # ØªØµØ¯ÙŠØ± Excel
â”‚   â”œâ”€â”€ query_cache.py      # Cache Ù„Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª
â”‚   â”œâ”€â”€ json_sanitizer.py   # ØªÙ†Ø¸ÙŠÙ JSON
â”‚   â””â”€â”€ error_messages.py   # Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£
â”‚
â”œâ”€â”€ visualization/          # Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©
â”‚   â”œâ”€â”€ pandasai_engine.py  # Ù…Ø­Ø±Ùƒ PandasAI
â”‚   â””â”€â”€ prompts.py          # Prompts Ù„Ù„Ø±Ø³ÙˆÙ…
â”‚
â””â”€â”€ observability/          # Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©
    â””â”€â”€ logging.py          # Ù†Ø¸Ø§Ù… Ø§Ù„Ø³Ø¬Ù„Ø§Øª
```

---

## âœ¨ Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

### 1. **Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø°ÙƒÙŠØ© (ChatGPT-like)**
- âœ… Ù†Ø¸Ø§Ù… Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª (Sessions â†’ Conversations â†’ Messages)
- âœ… Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ MongoDB
- âœ… Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø­ÙÙˆØ¸
- âœ… Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ø¨Ø³Ù‡ÙˆÙ„Ø©

### 2. **ÙÙ‡Ù… Ø§Ù„Ù„ØºØ© Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ©**
- âœ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø¥Ù„Ù‰ SQL ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
- âœ… Ø¯Ø¹Ù… Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©
- âœ… ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¯Ù‚Ø©
- âœ… ÙƒØ´Ù Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø­Ø³Ø§Ø³Ø© ÙˆØ­Ù…Ø§ÙŠØªÙ‡Ø§

### 3. **ØªØ­Ù„ÙŠÙ„ Ø¥Ø­ØµØ§Ø¦ÙŠ Ù…ØªÙ‚Ø¯Ù…**
- âœ… Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ØªÙˆØ³Ø·Ø§Øª ÙˆØ§Ù„ÙˆØ³ÙŠØ· ÙˆØ§Ù„Ø§Ù†Ø­Ø±Ø§Ù Ø§Ù„Ù…Ø¹ÙŠØ§Ø±ÙŠ
- âœ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù‚ØµÙˆÙ‰ ÙˆØ§Ù„Ø¯Ù†ÙŠØ§
- âœ… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª Ø§Ù„Ø²Ù…Ù†ÙŠØ©
- âœ… Ù…Ù‚Ø§Ø±Ù†Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª

### 4. **Ø±Ø³ÙˆÙ… Ø¨ÙŠØ§Ù†ÙŠØ© Ø§Ø­ØªØ±Ø§ÙÙŠØ©**
- âœ… Ù…Ø®Ø·Ø·Ø§Øª Ø£Ø¹Ù…Ø¯Ø© (Bar Charts)
- âœ… Ù…Ø®Ø·Ø·Ø§Øª Ø®Ø·ÙŠØ© (Line Charts)
- âœ… Ù…Ø®Ø·Ø·Ø§Øª Ù…Ø¨Ø¹Ø«Ø±Ø© (Scatter Plots)
- âœ… Ù…Ø®Ø·Ø·Ø§Øª Ø¯Ø§Ø¦Ø±ÙŠØ© (Pie Charts)
- âœ… ØªØµØ¯ÙŠØ± Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø© (1200x700, 100 DPI)

### 5. **ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª**
- âœ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ…Ù„Ù Excel
- âœ… Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø­ØªÙ‰ 100 ØµÙ)
- âœ… Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ø¹Ø¨Ø± query_id
- âœ… Ø­ÙØ¸ Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª ÙÙŠ Cache

### 6. **Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø­Ù…Ø§ÙŠØ©**
- âœ… ÙØ­Øµ SQL Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø£Ù…Ø§Ù† (SELECT ÙÙ‚Ø·)
- âœ… Ø­Ù…Ø§ÙŠØ© Ù…Ù† SQL Injection
- âœ… ÙƒØ´Ù Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø­Ø³Ø§Ø³Ø© (Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ ÙˆØ§Ù„Ø£Ø¹Ù…Ø¯Ø©)
- âœ… API Key Authentication (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
- âœ… CORS Configurable

### 7. **Ø£Ø¯Ø§Ø¡ Ù…Ø­Ø³Ù‘Ù†**
- âœ… Cache Ù„Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª (TTL 1 Ø³Ø§Ø¹Ø©)
- âœ… Connection Pooling Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- âœ… Ù…Ø¹Ø§Ù„Ø¬Ø© ØºÙŠØ± Ù…ØªØ²Ø§Ù…Ù†Ø© (Async/Await)
- âœ… ØªØ­Ø³ÙŠÙ† Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª SQL ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹

---

## ğŸ”„ Ø¢Ù„ÙŠØ© Ø§Ù„Ø¹Ù…Ù„ (Workflow)

### 1. **ØªØ¯ÙÙ‚ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø³Ø¤Ø§Ù„**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Question  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Sensitive Question Detection    â”‚
â”‚     (Gemini AI)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚  Yes?   â”‚  â”€â”€â”€â”€â”€â”€â–º Reject (Ø±Ø³Ø§Ù„Ø© Ù…Ù‡Ø°Ø¨Ø©)
    â”‚  No?    â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Question Classification         â”‚
â”‚     (Database-related?)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚  Yes?   â”‚
    â”‚  No?    â”‚  â”€â”€â”€â”€â”€â”€â–º General Answer
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. Question Refinement             â”‚
â”‚     (Gemini - ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø³Ø¤Ø§Ù„)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. Schema Retrieval (RAG)          â”‚
â”‚     (Ø¬Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. SQL Generation                  â”‚
â”‚     (LangChain + OpenAI/Gemini)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6. SQL Validation & Security       â”‚
â”‚     (ÙØ­Øµ Ø§Ù„Ø£Ù…Ø§Ù†)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  7. SQL Execution                   â”‚
â”‚     (PostgreSQL)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  8. Statistical Analysis            â”‚
â”‚     (Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  9. Response Formatting             â”‚
â”‚     (Gemini - Ø¥Ø¬Ø§Ø¨Ø© Ù…Ù‡Ù†ÙŠØ©)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  10. Chart Generation (Optional)    â”‚
â”‚      (PandasAI + Gemini)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  11. Save to MongoDB                â”‚
â”‚      (Conversation + Message)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  12. Return Response                â”‚
â”‚      (JSON with all data)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. **Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª (Conversation System)**

```
Session (Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…)
  â”‚
  â”œâ”€â”€ Conversation 1 (Ù…Ø­Ø§Ø¯Ø«Ø© "ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª")
  â”‚   â”œâ”€â”€ Message 1: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ØŸ"
  â”‚   â”‚   â”œâ”€â”€ Question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ØŸ"
  â”‚   â”‚   â”œâ”€â”€ Answer: "ÙŠÙˆØ¬Ø¯ 599 Ø¹Ù…ÙŠÙ„"
  â”‚   â”‚   â”œâ”€â”€ SQL: "SELECT COUNT(*) FROM customer"
  â”‚   â”‚   â”œâ”€â”€ Data: [...]
  â”‚   â”‚   â”œâ”€â”€ Chart: null
  â”‚   â”‚   â””â”€â”€ query_id: "xxx"
  â”‚   â”‚
  â”‚   â”œâ”€â”€ Message 2: "Ø§Ø¹Ø±Ø¶ Ø£Ø¹Ù„Ù‰ 10 Ø¹Ù…Ù„Ø§Ø¡"
  â”‚   â”‚   â”œâ”€â”€ Question: "Ø§Ø¹Ø±Ø¶ Ø£Ø¹Ù„Ù‰ 10 Ø¹Ù…Ù„Ø§Ø¡"
  â”‚   â”‚   â”œâ”€â”€ Answer: "Ø¥Ù„ÙŠÙƒ Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø£Ø¹Ù„Ù‰ 10..."
  â”‚   â”‚   â”œâ”€â”€ SQL: "SELECT ... ORDER BY ... LIMIT 10"
  â”‚   â”‚   â”œâ”€â”€ Data: [10 rows]
  â”‚   â”‚   â”œâ”€â”€ Chart: "bar_chart.png"
  â”‚   â”‚   â””â”€â”€ query_id: "yyy"
  â”‚   â”‚
  â”‚   â””â”€â”€ Message 3: "Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©"
  â”‚       â”œâ”€â”€ Question: "Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©"
  â”‚       â”œâ”€â”€ Answer: "ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ..."
  â”‚       â”œâ”€â”€ SQL: "SELECT DATE_TRUNC..."
  â”‚       â”œâ”€â”€ Data: [4 rows]
  â”‚       â”œâ”€â”€ Chart: "line_chart.png"
  â”‚       â””â”€â”€ query_id: "zzz"
  â”‚
  â””â”€â”€ Conversation 2 (Ù…Ø­Ø§Ø¯Ø«Ø© "ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±")
      â”œâ”€â”€ Message 1: "Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±"
      â””â”€â”€ Message 2: "Ù…Ù‚Ø§Ø±Ù†Ø© Ù…Ø¹ Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø³Ø§Ø¨Ù‚"
```

---

## ğŸ›  Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©

### 1. **Backend Framework**
- **FastAPI** (0.104.1): Ø¥Ø·Ø§Ø± Ø¹Ù…Ù„ Ø­Ø¯ÙŠØ« ÙˆØ³Ø±ÙŠØ¹ Ù„Ø¨Ù†Ø§Ø¡ APIs
- **Uvicorn**: ASGI server Ù„Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¹Ø§Ù„ÙŠ
- **Pydantic**: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„ØªØ³Ù„Ø³Ù„

### 2. **Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª**
- **PostgreSQL**: Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (SQL)
- **MongoDB** (Motor): ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª ÙˆØ§Ù„Ø¬Ù„Ø³Ø§Øª (NoSQL)
- **SQLAlchemy**: ORM Ù„Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ PostgreSQL
- **Connection Pooling**: Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡

### 3. **Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ**
- **Google Gemini 2.0 Flash**: 
  - ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
  - ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª
  - ÙƒØ´Ù Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø­Ø³Ø§Ø³Ø©
- **LangChain**: 
  - ØªÙˆÙ„ÙŠØ¯ SQL Ù…Ù† Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
  - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ù…Ø¹ LLM
- **PandasAI**: 
  - ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©
  - ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

### 4. **Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª**
- **Pandas**: Ù…Ø¹Ø§Ù„Ø¬Ø© ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- **NumPy**: Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø­Ø³Ø§Ø¨ÙŠØ©
- **Seaborn**: ØªØ­Ø³ÙŠÙ† Ø¬ÙˆØ¯Ø© Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©

### 5. **Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©**
- **OpenPyXL**: ØªØµØ¯ÙŠØ± Excel
- **SQLParse**: ØªØ­Ù„ÙŠÙ„ ÙˆÙØ­Øµ SQL
- **Tenacity**: Retry Logic

### 6. **Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© ÙˆØ§Ù„Ø£Ù…Ø§Ù†**
- **Python JSON Logger**: Ø³Ø¬Ù„Ø§Øª Ù…Ù†Ø¸Ù…Ø©
- **Prometheus Client**: Ø§Ù„Ù…Ù‚Ø§ÙŠÙŠØ³
- **API Key Authentication**: Ø­Ù…Ø§ÙŠØ© API

---

## ğŸ“¡ API Endpoints

### 1. **Health & Status**
```
GET /health
```
ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø¯Ù…Ø©

---

### 2. **Chat Endpoints**

#### Ø¥Ø±Ø³Ø§Ù„ Ø³Ø¤Ø§Ù„ (Chat)
```
POST /api/v1/chat
```
**Body:**
```json
{
  "question": "ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ØŸ",
  "session_id": "optional",
  "conversation_id": "optional",
  "include_data": false,
  "preview_rows": 10
}
```

**Response:**
```json
{
  "success": true,
  "answer": "ÙŠÙˆØ¬Ø¯ 599 Ø¹Ù…ÙŠÙ„ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",
  "has_data": true,
  "data": [...],
  "has_chart": false,
  "has_excel": false,
  "query_id": "xxx",
  "conversation_id": "yyy"
}
```

---

#### Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©
```
GET /api/v1/chat/data/{query_id}
```

#### ØªØ­Ù…ÙŠÙ„ Excel
```
GET /api/v1/chat/export/{query_id}
```

---

### 3. **Session Management**

#### Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù„Ø³Ø©
```
POST /api/v1/chat/session
```
**Body:**
```json
{
  "user_name": "Ø£Ø­Ù…Ø¯",
  "user_email": "ahmed@example.com",
  "user_metadata": {}
}
```

#### Ø¬Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø©
```
GET /api/v1/chat/session/{session_id}
```

#### Ù‚Ø§Ø¦Ù…Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù„Ø³Ø§Øª
```
GET /api/v1/chat/sessions?limit=50&skip=0
```

#### Ø¥Ù†Ù‡Ø§Ø¡ Ø¬Ù„Ø³Ø©
```
POST /api/v1/chat/session/{session_id}/end
```

---

### 4. **Conversation Management**

#### Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©
```
POST /api/v1/chat/conversation
```
**Body:**
```json
{
  "session_id": "xxx",
  "title": "ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª"
}
```

#### Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª
```
GET /api/v1/chat/conversations?session_id=xxx&limit=50
```

#### Ø¬Ù„Ø¨ Ø±Ø³Ø§Ø¦Ù„ Ù…Ø­Ø§Ø¯Ø«Ø©
```
GET /api/v1/chat/conversation/{conversation_id}/messages?limit=50
```

---

### 5. **History & Search**

#### Ø³Ø¬Ù„ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª
```
GET /api/v1/chat/history?session_id=xxx&limit=50&skip=0
```

#### Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø­Ø¯Ø¯Ø©
```
GET /api/v1/chat/history/{conversation_id}
```

#### Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª
```
GET /api/v1/chat/search?q=ÙƒÙ„Ù…Ø© Ø§Ù„Ø¨Ø­Ø«&limit=20
```

---

## ğŸ—„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

### 1. **PostgreSQL (Main Database)**
- Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©
- ÙŠØªÙ… Ø§Ø³ØªØ¹Ù„Ø§Ù…Ù‡Ø§ Ø¹Ø¨Ø± SQL Ø§Ù„Ù…ÙˆÙ„Ù‘Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
- Connection Pooling Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡

### 2. **MongoDB (Chat Database)**

#### Collection: `sessions`
```json
{
  "_id": ObjectId("..."),
  "session_id": "uuid",
  "user_name": "Ø£Ø­Ù…Ø¯",
  "user_email": "ahmed@example.com",
  "user_metadata": {},
  "created_at": ISODate("..."),
  "last_activity": ISODate("..."),
  "conversation_count": 5,
  "is_active": true
}
```

#### Collection: `conversation_threads`
```json
{
  "_id": ObjectId("..."),
  "conversation_id": "uuid",
  "session_id": "uuid",
  "title": "ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª",
  "created_at": ISODate("..."),
  "last_activity": ISODate("..."),
  "message_count": 10,
  "is_active": true
}
```

#### Collection: `messages`
```json
{
  "_id": ObjectId("..."),
  "conversation_id": "uuid",
  "session_id": "uuid",
  "question": "ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ØŸ",
  "answer": "ÙŠÙˆØ¬Ø¯ 599 Ø¹Ù…ÙŠÙ„",
  "sql_query": "SELECT COUNT(*) FROM customer",
  "data": [...],
  "query_id": "uuid",
  "excel_file": "exports/xxx.xlsx",
  "chart": {
    "type": "bar",
    "url": "/charts/generated/xxx.png"
  },
  "metadata": {},
  "created_at": ISODate("...")
}
```

---

## ğŸ” Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø­Ù…Ø§ÙŠØ©

### 1. **SQL Security**
- âœ… ÙØ­Øµ SQL Ù‚Ø¨Ù„ Ø§Ù„ØªÙ†ÙÙŠØ°
- âœ… Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ù€ SELECT ÙÙ‚Ø· (Ù„Ø§ UPDATE/DELETE/INSERT)
- âœ… Ø­Ù…Ø§ÙŠØ© Ù…Ù† SQL Injection
- âœ… ÙØ­Øµ LIMIT clause (ØªØ­Ø°ÙŠØ±)

### 2. **Sensitive Data Protection**
- âœ… ÙƒØ´Ù Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø¹Ù† Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ ÙˆØ§Ù„Ø£Ø¹Ù…Ø¯Ø©
- âœ… Ø±ÙØ¶ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø­Ø³Ø§Ø³Ø© Ø¨Ø´ÙƒÙ„ Ù…Ù‡Ø°Ø¨
- âœ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ù…Ù† Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø§Øª

### 3. **API Security**
- âœ… API Key Authentication (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
- âœ… CORS Configurable
- âœ… Input Validation (Pydantic)
- âœ… Error Handling Ø¢Ù…Ù†

### 4. **Data Privacy**
- âœ… Ø¹Ø²Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ø¬Ù„Ø³Ø§Øª
- âœ… Ù„Ø§ ÙŠØªÙ… Ø­ÙØ¸ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±
- âœ… ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸

---

## âš¡ Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª

### 1. **Caching**
- **Query Cache**: ØªØ®Ø²ÙŠÙ† Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª Ù„Ù…Ø¯Ø© Ø³Ø§Ø¹Ø©
- **Schema Cache**: ØªØ®Ø²ÙŠÙ† Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Schema
- **In-Memory Cache**: Ø³Ø±ÙŠØ¹ Ø§Ù„ÙˆØµÙˆÙ„

### 2. **Database Optimization**
- Connection Pooling (10 connections)
- Async Database Operations
- Indexed Queries ÙÙŠ MongoDB

### 3. **Code Optimization**
- Async/Await Ù„Ù„Ø¹Ù…Ù„ÙŠØ§Øª ØºÙŠØ± Ø§Ù„Ù…ØªØ²Ø§Ù…Ù†Ø©
- Lazy Loading Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø©
- Data Truncation Ù„Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø§Øª

---

## ğŸ“Š Ø§Ù„Ø®ØµØ§Ø¦Øµ Ø§Ù„ØªÙ‚Ù†ÙŠØ©

### 1. **Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª**
```python
# API
API_TITLE: "PostgreSQL Chat API"
API_VERSION: "1.0.0"
API_PREFIX: "/api/v1"
PORT: 3300

# LLM
GEMINI_MODEL: "gemini-2.0-flash"
GEMINI_TEMPERATURE: 0.3

# Database
DB_POOL_SIZE: 10
DB_MAX_OVERFLOW: 20

# SQL Security
SQL_TIMEOUT_SECONDS: 30
SQL_MAX_ROWS: 1000
```

### 2. **Limits**
- Maximum Question Length: 1000 characters
- Maximum Preview Rows: 100 rows
- Query Cache TTL: 1 hour
- SQL Timeout: 30 seconds

### 3. **File Storage**
- Charts: `charts/generated/`
- Excel: `exports/`
- Static Files: Served via FastAPI

---

## ğŸ”„ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡

### 1. **Error Types**
- **400 Bad Request**: Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©
- **401 Unauthorized**: API Key ØºÙŠØ± ØµØ­ÙŠØ­
- **404 Not Found**: Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©/Ø§Ù„Ø¬Ù„Ø³Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©
- **500 Internal Server Error**: Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ±
- **503 Service Unavailable**: MongoDB ØºÙŠØ± Ù…ØªØ§Ø­

### 2. **Error Handling**
- âœ… Ù…Ø¹Ø§Ù„Ø¬Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ù„Ø£Ø®Ø·Ø§Ø¡
- âœ… Ø±Ø³Ø§Ø¦Ù„ Ø®Ø·Ø£ ÙˆØ§Ø¶Ø­Ø© ÙˆÙ…Ù‡Ù†ÙŠØ©
- âœ… Logging Ù„Ù„Ø£Ø®Ø·Ø§Ø¡
- âœ… Graceful Degradation (Ù…Ø«Ù„ MongoDB)

---

## ğŸ“ˆ Ø§Ù„Ù…Ù‚Ø§ÙŠÙŠØ³ ÙˆØ§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©

### 1. **Logging**
- JSON Format Ù„Ù„Ø³Ù‡ÙˆÙ„Ø©
- Structured Logging
- Different Log Levels (INFO, WARNING, ERROR)
- Task IDs Ù„Ù„ØªØªØ¨Ø¹

### 2. **Metrics (Optional)**
- Prometheus Integration
- Request Counts
- Response Times
- Error Rates

---

## ğŸš€ Ø§Ù„Ù†Ø´Ø± ÙˆØ§Ù„ØªØ´ØºÙŠÙ„

### 1. **Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…**
- Python 3.12+
- PostgreSQL
- MongoDB
- Virtual Environment

### 2. **Ø§Ù„ØªØ«Ø¨ÙŠØª**
```bash
# Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ¦Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
python -m venv venv
source venv/bin/activate  # Linux/Mac
# Ø£Ùˆ
venv\Scripts\activate  # Windows

# ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ¨Ø¹ÙŠØ§Øª
pip install -r requirements.txt

# Ø¥Ø¹Ø¯Ø§Ø¯ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©
cp .env.example .env
# ØªØ¹Ø¯ÙŠÙ„ .env Ø¨Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª

# ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø©
python -m app.main
# Ø£Ùˆ
uvicorn app.main:app --host 0.0.0.0 --port 3300
```

### 3. **Docker (Optional)**
```bash
docker build -t postgresql-chat-api .
docker run -p 3300:3300 postgresql-chat-api
```

---

## ğŸ“‹ Ù…Ù„Ø®Øµ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª

### Endpoints
- **Total Endpoints**: 14 endpoint
- **Chat Endpoints**: 1
- **Session Endpoints**: 4
- **Conversation Endpoints**: 3
- **History Endpoints**: 3
- **Data Endpoints**: 3

### Features
- âœ… **Conversation Threads**: Ù…Ø«Ù„ ChatGPT
- âœ… **Chart Generation**: 4 Ø£Ù†ÙˆØ§Ø¹ (bar, line, scatter, pie)
- âœ… **Excel Export**: ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- âœ… **Statistical Analysis**: ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„
- âœ… **Search**: Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ØªØ§Ø±ÙŠØ®
- âœ… **Security**: Ø­Ù…Ø§ÙŠØ© Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª

### Databases
- **PostgreSQL**: Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
- **MongoDB**: ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª ÙˆØ§Ù„Ø¬Ù„Ø³Ø§Øª
- **In-Memory Cache**: Ù„Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª

---

## ğŸ¯ Ø§Ù„Ø®Ù„Ø§ØµØ©

**PostgreSQL Chat API** Ù‡ÙŠ Ø®Ø¯Ù…Ø© Ù…ØªÙƒØ§Ù…Ù„Ø© ÙˆØ§Ø­ØªØ±Ø§ÙÙŠØ© ØªØªÙŠØ­:
- âœ… Ø§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù„ØºØ© Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ©
- âœ… Ø­ÙØ¸ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø¨Ø´ÙƒÙ„ Ø§Ø­ØªØ±Ø§ÙÙŠ
- âœ… ØªÙˆÙ„ÙŠØ¯ Ø±Ø³ÙˆÙ… Ø¨ÙŠØ§Ù†ÙŠØ© ÙˆØªØ­Ù„ÙŠÙ„Ø§Øª Ø¥Ø­ØµØ§Ø¦ÙŠØ©
- âœ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØªØ­Ù„ÙŠÙ„Ù‡Ø§
- âœ… Ø£Ù…Ø§Ù† ÙˆØ­Ù…Ø§ÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø©

Ø§Ù„Ø®Ø¯Ù…Ø© Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Ø¨ÙŠØ¦Ø© Ø§Ù„Ø¥Ù†ØªØ§Ø¬ ÙˆØªØ¯Ø¹Ù… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ø¨Ù†Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø© chatbot Ø§Ø­ØªØ±Ø§ÙÙŠØ©.

---

**Ø§Ù„Ø¥ØµØ¯Ø§Ø±**: 1.0.0  
**Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«**: 2026-01-08  
**Ø§Ù„Ø­Ø§Ù„Ø©**: âœ… Production Ready
